<!DOCTYPE html>
<html>
<head>
	<title>OpenBeta</title>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta charset="utf-8" />
	<meta name='viewport' content='width=device-width,initial-scale=1,user-scalable=yes' />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-rc.1/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.0-rc.1/MarkerCluster.css" />
    <link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.0-rc.1/MarkerCluster.Default.css" />
	<link rel="stylesheet" type="text/css" href="lib/OverPassLayer.css" />

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css" />

</head>

<body style="height: 100vh">

	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-rc.1/leaflet.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.0.0/leaflet.ajax.js"></script>
	<script src='http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.0-rc.1/leaflet.markercluster.js'></script>
	<script src='https://code.jquery.com/jquery-1.11.0.min.js'></script>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


	<nav class="navbar navbar-default">
  	<div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
			<a href="#" class="navbar-left"><img src="https://avatars0.githubusercontent.com/u/19924141?v=3&s=200" style="width: 50px;"></a>
      <a class="navbar-brand" href="#">OpenBeta</a>
		</div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

      <form class="navbar-form navbar-left">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" id="search-input">
        </div>
        <button type="submit" class="btn btn-default" onclick="search()">Submit</button>
      </form>

			<ul class="nav navbar-nav navbar-right">
				<li > <a href="https://github.com/openbeta-io/openbeta-main"> Fork on Github!<img alt="" class="gh-mark" src="https://assets-cdn.github.com/images/modules/logos_page/GitHub-Mark.png" style="width:25px;"></a></li>
				<li><a href="#">Forum</a></li>
				<li><a href="#">About</a></li>
			 	<li><a href="https://github.com/login/oauth/authorize">Login</a></li>
		 </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
	</nav>


	<div class="container-fluid" style="height: 100%">
	  <div class="row" style="height: 100%">
			<div class="col-md-5">
				<div class="panel panel-default">
					<div class="panel-heading"><h3 class="panel-title">Panel title</h3></div>
				  <div class="panel-body">
				    Panel content
				  </div>
				</div>
				<h2></h2>
			</div>
			<div class="col-md-7 pull-right" style="height: 100%">
				<div class="panel panel-default" style="height: 100%">
				  <div class="panel-body" style="height: 100%">
						<div id="map" style="height: 100%"></div>
				  </div>
				</div>
			</div>
		</div>
	</div>

	<script>
		var url = 'https://api.github.com/repos/openbeta-io/geojson-poc/contents/data/yinyang-boundary.geojson';

		var mapboxUrl = "https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidmlldGdvZXN3ZXN0IiwiYSI6ImNpbzljZnVwNTAzM2x2d2x6OTRpb3JjMmQifQ.rcxOnDEeY4McXKDamMLOlA";

		var attribution ='Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery Â© <a href="http://mapbox.com">Mapbox</a>';

		var outdoorsLayer = L.tileLayer(mapboxUrl, {
										maxZoom: 22,
										attribution: attribution,
										id: 'mapbox.outdoors'
									}
		);

		var satelliteLayer = L.tileLayer(mapboxUrl, {
										maxZoom: 22,
										attribution: attribution,
										id: 'mapbox.satellite'
									}
		);

		var osmLayer = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
										maxZoom: 22,
										attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
										id: 'mapbox.light'
									}
		);

		var mymap = L.map("map",{
    			center: [36.1614211,-115.4500339],
    			zoom: 12,
    			layers: [outdoorsLayer, satelliteLayer, osmLayer]
		});

		var baseMaps = {
		    "Satellite": satelliteLayer,
		    "Topo": outdoorsLayer,
		    'OpenStreetMap': osmLayer
		};
		L.control.layers(baseMaps).addTo(mymap);

		L.control.scale().addTo(mymap);


		var geojsonMarkerOptions = {
		    radius: 5,
		    fillColor: "#ff7800",
		    color: "#000",
		    weight: 1,
		    opacity: 1,
		    fillOpacity: 0.8
		};

		var markerClusters = L.markerClusterGroup({ disableClusteringAtZoom: 18, spiderfyOnMaxZoom: false });

		var calico_basin_routes = new L.GeoJSON.AJAX("data/calico-basin.geojson", {
      		onEachFeature:
      			function (feature, layer) {
       				//layer.setIcon(L.mapbox.marker.icon({'marker-symbol': 'circle-stroked', 'marker-color':'59245f'}));
        			layer.bindPopup(feature.properties.name);
        			markerClusters.addLayer(layer);
      		},
      		pointToLayer:
      			function (feature, latlng) {
        			return L.circleMarker(latlng, geojsonMarkerOptions);
    			}
    	});
		mymap.addLayer(markerClusters);


function search(){
	var query = $("#search-input").val();
	if (query != "") {
		alert("Search for " + query);
	}
}

   function queryOverpass() {
        var //bbString = formatBBox(),
            overpassQuery = encodeURIComponent('node(around:50000,36.14893,-115.42279)["sport"="climbing"] ;out body qt;'),
            overpassURL = "http://overpass-api.de/api/interpreter?data=[out:json];" + overpassQuery;

        $.ajax({
            url : overpassURL,
            type : 'GET',
            crossDomain : true,
            success : function (data) {
            	console.log(data)
                makeMarkers(data);
            },
            error : function (request, status, errorThrown) {
                window.alert("Overpass Query failed with error: \n" + errorThrown);
            }
        });
	}

	function _getPoiPopupHTML(tags, id) {

        var row,
        link = document.createElement('a'),
        table = document.createElement('table'),
        div = document.createElement('div');

        link.href = 'http://www.openstreetmap.org/edit?editor=id&node=' + id;
        link.appendChild(document.createTextNode('Edit this entry in iD'));

        table.style.borderSpacing = '10px';
        table.style.borderCollapse = 'separate';

        for (var key in tags){

            row = table.insertRow(0);
            row.insertCell(0).appendChild(document.createTextNode(key));
            row.insertCell(1).appendChild(document.createTextNode(tags[key]));
        }

        div.appendChild(link);
        div.appendChild(table);

        return div;
}

</script>
</body>
</html>
